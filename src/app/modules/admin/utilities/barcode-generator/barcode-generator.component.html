<div class="flex flex-col flex-auto min-w-0 admin-page-container">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between p-6 sm:py-8 sm:px-10 border-b bg-card">
        <div class="flex-1 min-w-0">
            <div class="flex items-center">
                <mat-icon class="icon-size-12 text-primary mr-3" [svgIcon]="'heroicons_outline:qr-code'"></mat-icon>
                <h2 class="text-3xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate">
                    Generador de Códigos de Barras
                </h2>
            </div>
            <div class="ml-15 mt-2">
                <p class="text-secondary">
                    Genere e imprima códigos de barras para sus herramientas
                </p>
            </div>
        </div>
    </div>

    <!-- Main -->
    <div class="flex-auto p-6 sm:p-10">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Panel - Tool Selection -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Search and Filters -->
                <div class="bg-card shadow rounded-2xl p-6">
                    <h3 class="text-lg font-medium mb-4">Buscar Herramientas</h3>
                    <form [formGroup]="searchForm" class="space-y-4">
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <mat-form-field class="flex-auto">
                                <mat-label>Búsqueda</mat-label>
                                <input matInput formControlName="search" placeholder="Código o nombre">
                                <mat-icon matPrefix [svgIcon]="'heroicons_outline:magnifying-glass'"></mat-icon>
                            </mat-form-field>

                            <mat-form-field class="flex-auto">
                                <mat-label>Categoría</mat-label>
                                <mat-select formControlName="category">
                                    <mat-option [value]="''">Todas</mat-option>
                                    <mat-option value="measurement">Medición</mat-option>
                                    <mat-option value="power">Eléctricas</mat-option>
                                    <mat-option value="hand">Manuales</mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field class="flex-auto">
                                <mat-label>Almacén</mat-label>
                                <mat-select formControlName="warehouse">
                                    <mat-option [value]="''">Todos</mat-option>
                                    <mat-option value="main">Principal</mat-option>
                                    <mat-option value="secondary">Secundario</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="flex items-center gap-3">
                            <button mat-flat-button [color]="'primary'" (click)="searchTools()" type="button">
                                <mat-icon [svgIcon]="'heroicons_outline:magnifying-glass'"></mat-icon>
                                <span class="ml-2">Buscar</span>
                            </button>
                            <button mat-stroked-button (click)="selectAll()" type="button" [disabled]="tools.length === 0">
                                <mat-icon [svgIcon]="'heroicons_outline:check-circle'"></mat-icon>
                                <span class="ml-2">Seleccionar Todo</span>
                            </button>
                            <button mat-stroked-button (click)="clearSelection()" type="button" [disabled]="selectedTools.length === 0">
                                <mat-icon [svgIcon]="'heroicons_outline:x-mark'"></mat-icon>
                                <span class="ml-2">Limpiar</span>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Results Table -->
                <div class="bg-card shadow rounded-2xl overflow-hidden">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-medium">
                            Herramientas Disponibles
                            <span class="text-secondary ml-2" *ngIf="selectedTools.length > 0">
                                ({{ selectedTools.length }} seleccionadas)
                            </span>
                        </h3>
                    </div>

                    <div *ngIf="loading" class="flex items-center justify-center h-64">
                        <mat-icon class="animate-spin icon-size-12" [svgIcon]="'heroicons_outline:arrow-path'"></mat-icon>
                    </div>

                    <div *ngIf="!loading && tools.length === 0" class="flex flex-col items-center justify-center h-64 text-secondary">
                        <mat-icon class="icon-size-16 mb-4" [svgIcon]="'heroicons_outline:wrench-screwdriver'"></mat-icon>
                        <p class="text-lg font-medium">No se encontraron herramientas</p>
                        <p class="text-sm">Realice una búsqueda para encontrar herramientas</p>
                    </div>

                    <div *ngIf="!loading && tools.length > 0" class="overflow-x-auto">
                        <table mat-table [dataSource]="tools" class="w-full">
                            <!-- Select Column -->
                            <ng-container matColumnDef="select">
                                <th mat-header-cell *matHeaderCellDef class="font-semibold w-16">Sel.</th>
                                <td mat-cell *matCellDef="let tool">
                                    <mat-checkbox
                                        [checked]="isToolSelected(tool)"
                                        (change)="toggleToolSelection(tool)">
                                    </mat-checkbox>
                                </td>
                            </ng-container>

                            <!-- Code Column -->
                            <ng-container matColumnDef="code">
                                <th mat-header-cell *matHeaderCellDef class="font-semibold">Código</th>
                                <td mat-cell *matCellDef="let tool" class="font-medium">{{ tool.code }}</td>
                            </ng-container>

                            <!-- Name Column -->
                            <ng-container matColumnDef="name">
                                <th mat-header-cell *matHeaderCellDef class="font-semibold">Nombre</th>
                                <td mat-cell *matCellDef="let tool">{{ tool.name }}</td>
                            </ng-container>

                            <!-- Category Column -->
                            <ng-container matColumnDef="category">
                                <th mat-header-cell *matHeaderCellDef class="font-semibold">Categoría</th>
                                <td mat-cell *matCellDef="let tool">{{ tool.category }}</td>
                            </ng-container>

                            <!-- Location Column -->
                            <ng-container matColumnDef="location">
                                <th mat-header-cell *matHeaderCellDef class="font-semibold">Ubicación</th>
                                <td mat-cell *matCellDef="let tool">{{ tool.location || '-' }}</td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Generation Options -->
            <div class="space-y-6">
                <!-- Options Card -->
                <div class="bg-card shadow rounded-2xl p-6">
                    <h3 class="text-lg font-medium mb-4">Opciones de Generación</h3>

                    <div class="space-y-6">
                        <mat-form-field class="w-full">
                            <mat-label>Formato de Código</mat-label>
                            <mat-select [(ngModel)]="barcodeFormat">
                                <mat-option *ngFor="let format of barcodeFormats" [value]="format.value">
                                    {{ format.label }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field class="w-full">
                            <mat-label>Tamaño de Papel</mat-label>
                            <mat-select [(ngModel)]="paperSize">
                                <mat-option *ngFor="let size of paperSizes" [value]="size.value">
                                    {{ size.label }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-checkbox [(ngModel)]="includeDetails" class="block">
                            Incluir detalles de la herramienta
                        </mat-checkbox>
                    </div>
                </div>

                <!-- Preview Card -->
                <div class="bg-card shadow rounded-2xl p-6">
                    <h3 class="text-lg font-medium mb-4">Vista Previa</h3>

                    <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center">
                        <mat-icon class="icon-size-16 text-gray-400 mb-4" [svgIcon]="'heroicons_outline:qr-code'"></mat-icon>
                        <p class="text-sm text-secondary">La vista previa aparecerá aquí</p>
                        <p class="text-xs text-secondary mt-2">Formato: {{ barcodeFormat }}</p>
                    </div>
                </div>

                <!-- Actions Card -->
                <div class="bg-card shadow rounded-2xl p-6">
                    <h3 class="text-lg font-medium mb-4">Acciones</h3>

                    <div class="space-y-3">
                        <button
                            mat-flat-button
                            [color]="'primary'"
                            class="w-full"
                            (click)="generateBarcodes()"
                            [disabled]="selectedTools.length === 0">
                            <mat-icon [svgIcon]="'heroicons_outline:sparkles'"></mat-icon>
                            <span class="ml-2">Generar</span>
                        </button>

                        <button
                            mat-stroked-button
                            class="w-full"
                            (click)="printBarcodes()"
                            [disabled]="selectedTools.length === 0">
                            <mat-icon [svgIcon]="'heroicons_outline:printer'"></mat-icon>
                            <span class="ml-2">Imprimir</span>
                        </button>

                        <button
                            mat-stroked-button
                            class="w-full"
                            (click)="downloadBarcodes()"
                            [disabled]="selectedTools.length === 0">
                            <mat-icon [svgIcon]="'heroicons_outline:arrow-down-tray'"></mat-icon>
                            <span class="ml-2">Descargar PDF</span>
                        </button>
                    </div>

                    <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900 rounded-lg">
                        <div class="flex items-start">
                            <mat-icon class="text-blue-600 dark:text-blue-200 mr-2 mt-0.5" [svgIcon]="'heroicons_outline:information-circle'"></mat-icon>
                            <div class="text-sm text-blue-800 dark:text-blue-100">
                                <p class="font-medium mb-1">Herramientas seleccionadas:</p>
                                <p class="text-2xl font-bold">{{ selectedTools.length }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
