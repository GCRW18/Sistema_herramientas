<div class="flex flex-col flex-auto min-w-0">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between p-6 sm:py-8 sm:px-10 border-b bg-card">
        <div class="flex-1 min-w-0">
            <button mat-icon-button (click)="cancel()" class="mr-2">
                <mat-icon [svgIcon]="'heroicons_outline:arrow-left'"></mat-icon>
            </button>
            <h2 class="text-3xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate inline-block">
                Enviar a Cuarentena
            </h2>
        </div>
    </div>

    <!-- Main -->
    <div class="flex-auto p-6 sm:p-10">
        <div class="max-w-3xl mx-auto">
            <form [formGroup]="form" (ngSubmit)="save()" class="space-y-8">
                <!-- Información de Cuarentena -->
                <div class="bg-card shadow rounded-2xl p-6">
                    <h3 class="text-lg font-medium mb-4">Información de Cuarentena</h3>
                    <div class="grid grid-cols-1 gap-6">
                        <!-- Tool Selection -->
                        <mat-form-field class="w-full">
                            <mat-label>Herramienta</mat-label>
                            <mat-select formControlName="toolId" required>
                                <mat-option *ngFor="let tool of tools" [value]="tool.id">
                                    {{ tool.code }} - {{ tool.name }}
                                </mat-option>
                            </mat-select>
                            <mat-icon matPrefix [svgIcon]="'heroicons_outline:wrench-screwdriver'"></mat-icon>
                            <mat-error *ngIf="form.get('toolId')?.hasError('required')">
                                La herramienta es requerida
                            </mat-error>
                        </mat-form-field>

                        <!-- Reason -->
                        <mat-form-field class="w-full">
                            <mat-label>Motivo de Cuarentena</mat-label>
                            <mat-select formControlName="reason" required>
                                <mat-option *ngFor="let reason of reasons" [value]="reason.value">
                                    {{ reason.label }}
                                </mat-option>
                            </mat-select>
                            <mat-icon matPrefix [svgIcon]="'heroicons_outline:shield-exclamation'"></mat-icon>
                            <mat-error *ngIf="form.get('reason')?.hasError('required')">
                                El motivo es requerido
                            </mat-error>
                        </mat-form-field>

                        <!-- Description -->
                        <mat-form-field class="w-full">
                            <mat-label>Descripción del Problema</mat-label>
                            <textarea matInput formControlName="description" rows="4"
                                      placeholder="Describa detalladamente el motivo de la cuarentena..." required></textarea>
                            <mat-icon matPrefix [svgIcon]="'heroicons_outline:document-text'"></mat-icon>
                            <mat-error *ngIf="form.get('description')?.hasError('required')">
                                La descripción es requerida
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>

                <!-- Fechas -->
                <div class="bg-card shadow rounded-2xl p-6">
                    <h3 class="text-lg font-medium mb-4">Fechas</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <!-- Reported Date -->
                        <mat-form-field class="flex-auto">
                            <mat-label>Fecha de Reporte</mat-label>
                            <input matInput [matDatepicker]="reportedPicker" formControlName="reportedDate" required>
                            <mat-datepicker-toggle matSuffix [for]="reportedPicker"></mat-datepicker-toggle>
                            <mat-datepicker #reportedPicker></mat-datepicker>
                            <mat-icon matPrefix [svgIcon]="'heroicons_outline:calendar'"></mat-icon>
                            <mat-error *ngIf="form.get('reportedDate')?.hasError('required')">
                                La fecha de reporte es requerida
                            </mat-error>
                        </mat-form-field>

                        <!-- Expected Resolution Date -->
                        <mat-form-field class="flex-auto">
                            <mat-label>Fecha Estimada de Resolución</mat-label>
                            <input matInput [matDatepicker]="resolutionPicker" formControlName="expectedResolutionDate">
                            <mat-datepicker-toggle matSuffix [for]="resolutionPicker"></mat-datepicker-toggle>
                            <mat-datepicker #resolutionPicker></mat-datepicker>
                            <mat-icon matPrefix [svgIcon]="'heroicons_outline:calendar-days'"></mat-icon>
                            <mat-hint>Opcional - Fecha estimada para resolver el problema</mat-hint>
                        </mat-form-field>
                    </div>
                </div>

                <!-- Warning Message -->
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <mat-icon class="text-yellow-400 mr-3" [svgIcon]="'heroicons_outline:exclamation-triangle'"></mat-icon>
                        <div>
                            <p class="font-medium text-yellow-800">Importante</p>
                            <p class="text-sm text-yellow-700 mt-1">
                                Las herramientas en cuarentena no estarán disponibles para uso hasta que se resuelva el problema
                                y sean liberadas del estado de cuarentena.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex items-center justify-end gap-4">
                    <button mat-button type="button" (click)="cancel()" [disabled]="loading">
                        Cancelar
                    </button>
                    <button mat-flat-button [color]="'warn'" type="submit" [disabled]="form.invalid || loading">
                        <mat-icon *ngIf="loading" class="animate-spin" [svgIcon]="'heroicons_outline:arrow-path'"></mat-icon>
                        <mat-icon *ngIf="!loading" [svgIcon]="'heroicons_outline:shield-exclamation'"></mat-icon>
                        <span class="ml-2">{{ loading ? 'Enviando...' : 'Enviar a Cuarentena' }}</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
